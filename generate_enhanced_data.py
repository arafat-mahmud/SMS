import csv
import random
import re
import string

# --- Existing Patterns from main.py (Expanded) ---
spam_patterns = [
    # লটারি/পুরস্কার স্ক্যাম
    "আপনার মোবাইল নম্বর {company} লটারিতে বিজয়ী হয়েছে! {amount} টাকা জিতেছেন। কল করুন: {phone}",
    "অভিনন্দন! আপনি {company} এর {prize} জিতেছেন। দাবি করতে {phone} নম্বরে কল করুন।",
    "প্রিয় গ্রাহক, আপনার নাম্বার র্যান্ডম ড্র তে নির্বাচিত। পুরস্কার {amount} টাকা। কল: {phone}",
    # জাল ব্যাংকিং/পেমেন্ট সতর্কতা
    "আপনার {bank} একাউন্ট থেকে {amount} টাকা উত্তোলন হয়েছে। বন্ধ করতে {phone} এ কল করুন।",
    "{bank} alert: আপনার একাউন্ট সাসপেন্ড হতে পারে। ভেরিফাই করুন: {link}",
    "জরুরি! {bank} কার্ড ব্লক হবে। তথ্য আপডেট করুন {phone}",
    "আপনার বিকাশ একাউন্ট থেকে {amount} টাকা ডেবিট। বাতিল করতে {phone} এ কল দিন।",
    "নগদ/রকেট একাউন্ট ভেরিফিকেশন জরুরি। {phone} নম্বরে কল করুন এখনই।",
    # ঋণের অফার
    "ঋণ পাবেন মাত্র {hour} ঘন্টায়! কোন কাগজপত্র লাগবে না। {amount} টাকা পর্যন্ত। কল: {phone}",
    "ইন্সট্যান্ট লোন সার্ভিস। {amount} টাকা পাবেন {hour} ঘন্টায়। আবেদন করুন: {phone}",
    "{company} থেকে পার্সোনাল লোন। সুদের হার মাত্র {percent}%। যোগাযোগ: {phone}",
    "জমি বন্ধক রেখে ঋণ নিন। সহজ শর্তে {amount} টাকা। কল করুন {phone}",
    # চাকরি/আয়ের স্ক্যাম
    "ঘরে বসে মাসে {amount} টাকা আয়। কোন বিনিয়োগ লাগবে না। হোয়াটসঅ্যাপ: {phone}",
    "অনলাইনে কাজ করে দৈনিক {amount} টাকা আয়। রেজিস্ট্রেশন ফি মাত্র {fee} টাকা। {phone}",
    "বিদেশে চাকরির সুযোগ। স্যালারি {amount} টাকা। ভিসা গ্যারান্টি। যোগাযোগ: {phone}",
    "পার্ট টাইম জব। দিনে {hour} ঘন্টা কাজ করে {amount} টাকা আয়। কল: {phone}",
    "মোবাইল রিচার্জ এর ব্যবসা শুরু করুন। বিনিয়োগ {investment} টাকা। লাভ {percent}%। {phone}",
    # ই-কমার্স/পণ্যের অফার
    "বিশেষ অফার! {product} মাত্র {price} টাকায়। ফ্রি হোম ডেলিভারি। অর্ডার: {phone}",
    "{percent}% ছাড়ে {product} কিনুন। লিমিটেড স্টক। {company} অর্ডার করুন: {phone}",
    "{product} এর দাম কমেছে {percent}%। ক্যাশ অন ডেলিভারি। কল করুন: {phone}",
    "অরিজিনাল {product} সস্তায় পাবেন। ঢাকার বাহিরে কুরিয়ার ফ্রি। {phone}",
    # মোবাইল অপারেটরের জাল অফার
    "{operator} অফার: আনলিমিটেড ইন্টারনেট মাত্র {price} টাকায়। SMS YES {code}",
    "প্রিয় {operator} গ্রাহক, আপনি পাচ্ছেন {gb}GB ফ্রি। অ্যাক্টিভ করতে কল দিন {phone}",
    "{operator} থেকে ফ্রি {amount} টাকা রিচার্জ পাবেন। নিতে SMS করুন {code}",
    # বিনিয়োগ স্ক্যাম
    "{company} তে বিনিয়োগ করুন। মাসিক লাভ {percent}%। মিনিমাম {investment} টাকা। {phone}",
    "ক্রিপ্টো কারেন্সি ট্রেডিং শিখুন। দৈনিক {amount} টাকা আয়। রেজিস্টার করুন: {link}",
    "শেয়ার বাজারে বিনিয়োগ করুন। {percent}% রিটার্ন গ্যারান্টি। কল: {phone}",
    # স্বাস্থ্য/ওষুধ স্ক্যাম
    "{medicine} ট্যাবলেট মাত্র {price} টাকা। ১০০% কার্যকর। হোম ডেলিভারি। অর্ডার: {phone}",
    "দ্রুত ওজন কমান। {medicine} ব্যবহার করুন। গ্যারান্টি সহ। মূল্য {price} টাকা। {phone}",
    # রিয়েল এস্টেট স্ক্যাম
    "জমি কিনুন সস্তায়। {location} এ প্লট মাত্র {price} টাকা। বুকিং {deposit} টাকা। {phone}",
    "ফ্ল্যাট বুকিং চলছে। {location} এ {size} বর্গফুট। মূল্য {price} টাকা। যোগাযোগ: {phone}",
    # জাল সরকারি স্কিম
    "সরকারি স্কিম: {amount} টাকা অনুদান পাবেন। আবেদন ফি {fee} টাকা। কল করুন {phone}",
    "প্রধানমন্ত্রীর বিশেষ প্যাকেজ। {amount} টাকা সহায়তা। রেজিস্ট্রেশন: {phone}",
    # --- NEW PATTERNS FOR COVERAGE ---
    # রাজনৈতিক/প্রচারণা (Political)
    "আগামীকাল {location} এ বিশাল জনসভা। প্রধান অতিথি {name}। দলে দলে যোগ দিন।",
    "{party} এর পক্ষ থেকে সবাইকে ঈদের শুভেচ্ছা। - {name}",
    "দেশ ও দশের উন্নয়নে {symbol} মার্কায় ভোট দিন।",
    "আগামী {date} তারিখ সকাল ১০টায় {location} এ বিক্ষোভ মিছিল।",
    "চল চল {location} চল। {party} এর মহাসমাবেশ সফল করি।",
    "শান্তি ও উন্নয়নের প্রতীক {symbol} মার্কায় আপনার মূল্যবান ভোট দিন।",
    # ডেটিং/স্ক্যাম (Dating/Scam)
    "হাই, আমি {girl_name}। তোমার প্রোফাইল দেখলাম। কথা বলতে চাইলে কল করো: {phone}",
    "তোমার জন্য একটা গোপন মেসেজ আছে। শুনতে কল করো {phone} নম্বরে।",
    "একাকী লাগছে? আমার সাথে চ্যাট করতে ক্লিক করো: {link}",
    "{girl_name} তোমাকে মিস করছে। তার ভয়েস মেসেজ শুনতে ডায়াল করো {phone}",
    "তোমার এলাকায় নতুন বন্ধু খুঁজছো? এখানে ক্লিক করো: {link}",
    "সেক্সি ভিডিও চ্যাট করতে চাইলে এখনই জয়েন করো: {link}",
    # ম্যালওয়্যার/ভাইরাস (Malware/Virus)
    "আপনার ফোনে ভাইরাস ধরা পড়েছে! এখনই ক্লিন করতে ক্লিক করুন: {link}",
    "আপনার হোয়াটসঅ্যাপ আপডেট প্রয়োজন। পুরনো ভার্সন বন্ধ হয়ে যাবে। আপডেট: {link}",
    "ফ্রি অ্যান্টিভাইরাস ডাউনলোড করুন এবং ফোন ফাস্ট করুন: {link}",
    "আপনার ডিভাইসের মেমোরি ফুল। ক্লিন করতে ক্লিক করুন: {link}",
    "সতর্কতা! আপনার ফোন হ্যাক হতে পারে। সুরক্ষা চালু করুন: {link}",
    "ব্যাটারি সেভার অ্যাপ ইন্সটল করুন এবং চার্জ দ্বিগুণ করুন: {link}",
    # ভুয়া ডেলিভারি (Fake Delivery - Enhanced)
    "আপনার পার্সেলটি আমাদের অফিসে আটকে আছে। ডেলিভারি ফি {fee} টাকা দিয়ে ছাড়িয়ে নিন: {link}",
    "RedX: আপনার পার্সেল ডেলিভারি ব্যর্থ হয়েছে। পুনরায় শিডিউল করতে ক্লিক করুন: {link}",
    "Daraz: আপনার অর্ডারের ঠিকানা ভুল। সঠিক ঠিকানা দিতে লিংকে যান: {link}",
    "Pathao: রাইডার আপনার লোকেশন খুঁজে পাচ্ছে না। কল করুন: {phone}",
    "আপনার বিদেশ থেকে আসা পার্সেল কাস্টমসে আটকে আছে। ট্যাক্স দিন: {link}",
    # ফিশিং (Phishing - Enhanced)
    "বিকাশ: আপনার একাউন্ট নিষ্ক্রিয় করা হয়েছে। চালু করতে লিংকে ক্লিক করুন: {link}",
    "নগদ: ৫০০০ টাকা ক্যাশব্যাক পেতে এখনই অ্যাপ আপডেট করুন: {link}",
    "রকেট: কেওয়াইসি আপডেট না করলে লেনদেন বন্ধ হবে। আপডেট: {link}",
    "সোনালী ব্যাংক: আপনার একাউন্টে অস্বাভাবিক লেনদেন। চেক করুন: {link}",
    "ব্র্যাক ব্যাংক: আপনার কার্ডের মেয়াদ শেষ। রিনিউ করতে ক্লিক করুন: {link}",
]

ham_patterns = [
    # পারিবারিক কথোপকথন
    "আম্মু, আজ রাতে বাসায় খাবো না। তুমি খেয়ে নিও।",
    "বাবা, আমার একটু টাকা দরকার। পাঠাতে পারবে?",
    "আপু, তুমি কখন বাসায় আসবে? আমার একটা কাজ ছিল।",
    "ভাই, মায়ের ওষুধ কিনে আনতে হবে। তুমি কি নিয়ে আসতে পারবে?",
    "ছোট ভাই, তোর পরীক্ষা কেমন হলো? রেজাল্ট কবে দিবে?",
    "মা, আজ অফিস থেকে একটু দেরি হবে। তুমি ঘুমিয়ে পড়ো।",
    "আব্বু, আমি ঢাকা পৌঁছে গেছি। চিন্তা করবেন না।",
    # বন্ধু/সামাজিক
    "কি রে, কেমন আছিস? অনেক দিন দেখা নেই।",
    "আজ সন্ধ্যায় বাসায় থাকলে একটু আসবো। ঠিক আছে?",
    "দোস্ত, কাল ক্রিকেট খেলা আছে। আসবি তো?",
    "ভাই, তোর বাইকটা কি আজকে নিতে পারি? আমার একটা কাজ আছে।",
    "আজ রাতে গল্পের অ্যাডা আছে চা-স্টলে। আসবা?",
    "কিরে, কবে দেখা হবে? অনেক দিন হয়ে গেলো তো।",
    "তুই কি আজকে ক্লাসে এসেছিলি? নোটস দিতে পারবি?",
    # কাজ/পেশাদার
    "স্যার, আজ আমি একটু অসুস্থ। অফিসে আসতে পারবো না।",
    "বস, মিটিংটা কয়টায়? আমি রেডি আছি।",
    "ভাই, কালকের রিপোর্টটা কি জমা দিয়েছো? ডেডলাইন তো আজ।",
    "স্যার, আমার স্যালারি এখনো একাউন্টে আসেনি। একটু চেক করে দেখবেন?",
    "আপা, আজকের মিটিং কি ক্যান্সেল হয়েছে? একটু জানাবেন প্লিজ।",
    # দৈনন্দিন জীবন/ব্যবহারিক
    "ভাইয়া, বাসায় কেউ আছে? আমি দরজায় দাঁড়িয়ে আছি।",
    "আজ বাজার করে আনবো। কি কি লাগবে বলে দাও।",
    "গ্যাস শেষ হয়ে গেছে। নতুন সিলিন্ডার অর্ডার দিতে হবে।",
    "বিদ্যুৎ চলে গেছে। জেনারেটর চালু করা দরকার।",
    "আজ অনেক জ্যাম আছে। আমি একটু দেরি করে পৌঁছাবো।",
    "ফোনে চার্জ নেই। একটু পরে কল করছি।",
    "দোকানটা কয়টা পর্যন্ত খোলা থাকে? আমি যাচ্ছি।",
    # শুভেচ্ছা/উৎসব
    "ঈদ মুবারক! তুমি কেমন আছো?",
    "জন্মদিনের অনেক অনেক শুভেচ্ছা! আল্লাহ তোমার মঙ্গল করুন।",
    "বিজয় দিবসের শুভেচ্ছা। জয় বাংলা!",
    "নতুন বছরের শুভেচ্ছা। নতুন বছর সবার জন্য মঙ্গলময় হোক।",
    # স্বাস্থ্য/যত্ন
    "তোমার শরীর কেমন? ডাক্তার কি বলেছে?",
    "ওষুধ খেয়েছো? ঠিক সময়ে খাবে কিন্তু।",
    "আজ হাসপাতালে যাবো। তুমি কি সাথে আসতে পারবে?",
    "ডাক্তারের অ্যাপয়েন্টমেন্ট কাল সকাল ১০টায়। ভুলে যাবে না।",
    # শিক্ষা
    "আজকের ক্লাস কয়টায়? আমি ভুলে গেছি।",
    "পরীক্ষার রুটিন কি বের হয়েছে? একটু পাঠাতে পারবে?",
    "অ্যাসাইনমেন্ট জমা দেওয়ার শেষ তারিখ কবে?",
    "লাইব্রেরি কয়টা পর্যন্ত খোলা? আমার পড়তে যেতে হবে।",
    # খাবার/রেস্টুরেন্ট
    "আজ রাতে কি রান্না করবে? খিদে পেয়েছে।",
    "বাইরে থেকে খাবার অর্ডার দেবো? তুমি কি খাবে?",
    "বিরিয়ানি খাবে? আমি অর্ডার দিচ্ছি।",
    "চা বানিয়ে দাও তো। খুব ঘুম পাচ্ছে।",
    # শপিং
    "বাজারে পেঁয়াজের দাম কত? অনেক বেড়েছে নাকি?",
    "নতুন জামা কিনবো। তুমি কি সাথে যাবে?",
    "তোমার জুতা কোথা থেকে কিনেছিলে? দামটা কত ছিল?",
    "মোবাইল শপে নতুন ফোন এসেছে। একটু দেখে আসবো।",
    # পরিবহন
    "আজ ট্রেন ধরতে হবে। স্টেশনে পৌঁছাতে কতক্ষণ লাগবে?",
    "বাসে উঠেছি। আধা ঘন্টার মধ্যে পৌঁছাবো।",
    "আজ উবার নেবো নাকি সিএনজিতে যাবো?",
    "রিক্সা পাচ্ছি না। তুমি কি পিক করতে পারবে?",
    # আবহাওয়া/পরিবেশ
    "আজ অনেক গরম। এসি চালাতে হবে।",
    "বৃষ্টি হচ্ছে। ছাতা নিয়ে বের হবে।",
    "আজ কুয়াশা অনেক। গাড়ি চালাতে সাবধান থাকবে।",
    "তুমি কি জানো কাল থেকে ঠাণ্ডা পড়বে?",
    # ব্যাংকিং/আর্থিক (বৈধ)
    "আমার একাউন্ট নাম্বার দরকার। পাঠাতে পারবে?",
    "বিকাশে টাকা পাঠাও। আমার নাম্বার জানো তো?",
    "টাকাটা পেয়েছি। ধন্যবাদ ভাই।",
    "দোকানের ভাড়া দিতে হবে। টাকা রেডি রেখো।",
    # প্রযুক্তি
    "তোমার ওয়াইফাই পাসওয়ার্ড কি? আমার ইন্টারনেট নেই।",
    "ফোনটা হ্যাং করছে। রিস্টার্ট দিতে হবে।",
    "ল্যাপটপ চার্জার নিয়ে আসবে? আমার দরকার।",
    "তোমার ফোন নাম্বার সেভ হয়নি। আবার দাও তো।",
    # মোবাইল অপারেটর বৈধ বার্তা
    "সময় 00:00:12,কাটা হয়েছে 0.17 Taka,বর্তমান ব্যালেন্স 38.22 Taka",
    "সময় 00:00:37,কাটা হয়েছে 0.51 Taka,বর্তমান ব্যালেন্স 37.71 Taka",
    # বিকাশ বৈধ লেনদেন
    "আপনি 01773448862 থেকে 72.00 টাকা পেয়েছেন। ফি 0.00 টাকা। ব্যালেন্স 11,562.48 টাকা। TrxID CKJ6C7KUN4 at 19/11/2025 12:00",
    "আপনি 01859845470 থেকে 1,100.00 টাকা পেয়েছেন। ফি 0.00 টাকা। ব্যালেন্স 8,982.48 টাকা। TrxID CK00HI24BI at 24/11/2025 18:21",
    "আপনার বিকাশ ভেরিফিকেশন কোড 840223। কোডটি ২ মিনিটে মেয়াদ শেষ হবে। দয়া করে আপনার OTP বা PIN অন্যদের সাথে শেয়ার করবেন না।",
    "ICC Communication এ 800.00 টাকা পেমেন্ট সফল হয়েছে। ব্যালেন্স 3,052.48 টাকা। TrxID CL31Q0UTRT at 03/12/2025 00:20",
    "বিল সফলভাবে পরিশোধিত হয়েছে। Biller: ICCComm MMYYYY/Contact: 01721170869 A/C: 73054 Amount: Tk 600.00 Fee: Tk 0.00 TrxID: CL85VHUJ0X at 08/12/2025 13:25",
    "বিল সফলভাবে পরিশোধিত হয়েছে। Biller: WZPDCL MMYYYY/Contact: 112025 A/C: 201129120 Amount: Tk 1,448.00 Fee: Tk 0.00 TrxID: CL88VHVQS0 at 08/12/2025 13:26",
    "আপনি 01859845470 থেকে 100.00 টাকা পেয়েছেন। ফি 0.00 টাকা। ব্যালেন্স 8,107.39 টাকা। TrxID BKK1FD0EB9 at 20/11/2024 20:41",
    "আপনি রেমিট্যান্স পেয়েছেন। মোট: 12,402.50 টাকা সরকারি প্রণোদনা: 302.50 টাকা TrxID BKM3GGEY3F at 22/11/2024 09:33.",
    "বিল সফলভাবে পরিশোধিত হয়েছে। Biller: WZPDCL MMYYYY/Contact: 102024 A/C: 201129120 Amount: Tk 1,846.00 Fee: Tk 0.00 TrxID: BKN7HQ5RTN at 23/11/2024",
    # ব্যাংক বৈধ বার্তা
    "আপনার JBPLC একাউন্ট *5877 এ মেডিকেল কলেজ থেকে 1000.00 টাকা জমা হয়েছে at 03 Jul 25 14:18:52 ব্যালেন্স 1040 টাকা। Enjoy Amar Sanchoy Amar Munafa",
    "আপনার JBPLC একাউন্ট *5877 এ বরিশাল কর্পোরেট থেকে 1000.00 টাকা জমা হয়েছে at 06 Aug 25 13:39:33 ব্যালেন্স 1040 টাকা।",
    "প্রিয় মহোদয়, আপনার JBPLC A/C **5451 এ 2583.66 টাকা (সুদ) জমা হয়েছে on 10-SEP-2025. C/B is BDT0. eJanata app ব্যবহার করুন i-banking এর জন্য। ধন্যবাদ",
    "আপনার JBPLC একাউন্ট *5877 থেকে আলীনগর এ 40.00 টাকা ডেবিট হয়েছে at 11 Sep 25 12:11:44 ব্যালেন্স 0 টাকা। যেকোনো শাখা থেকে A-Challan সুবিধা নিন",
    "প্রিয় মহোদয়, আপনার SMS Alert মোবাইল নম্বর 01712911614 থেকে 01721170869 এ পরিবর্তন করা হয়েছে জনতা ব্যাংক পিএলসি তে। এখন থেকে নতুন নম্বরে SMS পাবেন। ধন্যবাদ।",
    "আপনার JBPLC ATM Card No.7012***4920 থেকে 20015.00 টাকা ডেবিট হয়েছে। ব্যালেন্স 14646.31 টাকা। at 02 Dec 25 17:44:55 from বরিশাল ATM. Visit www.jb.com.bd for services",
    "আপনার OTP হলো 708411। এটি ৩ মিনিট বৈধ থাকবে। কখনো OTP, PIN, CVV, Expiry Date এবং Password কারো সাথে শেয়ার করবেন না। TBL-Digital Banking.",
    # বিকাশ সিএস সেবা বার্তা
    "আপনার সার্ভিস রিকোয়েস্ট নম্বর 8953। দয়া করে এটি শুধুমাত্র বিকাশ গ্রাহক সেবা এর বিকাশ কাস্টমার সার্ভিস এক্সিকিউটিভ অথবা livechat.bkash.com ছাড়া অন্য কারো সাথে শেয়ার করবেন না।",
    "শুধুমাত্র বিকাশ লাইভচ্যাট স্ক্রিনে সার্ভিস রিকোয়েস্ট নাম্বার 021065 লিখুন। কল বা SMS এর মাধ্যমে নাম্বারটি কারো সাথে শেয়ার করবেন না।",
    # সরকারি তথ্য বার্তা
    "আজ ২৩ মে ২০২৪, বিশ্ব মেটেলিজি দিবস। এবারের প্রতিপাদ্য- 'টেকসই ভবিষ্যৎ বিনির্মাণে আজকের পরিমাপ', থিএসচিআই, শিল্প মন্ত্রণালয়।",
    '"অর্থনৈতিক শুমারি ২০২৪ এর আওতায় দেশের সকল খানা ও প্রতিষ্ঠান তালিকাভুক্ত করা হচ্ছ। জাতীয় স্বার্থপূর্ণ এ কার্যক্রমে আপনার তথ্য দিয়ে সহযোগিতা করুন" - বাংলাদেশ পরিসংখ্যান ব্যুরো।',
    "বাংলাদেশ নৌবাহিনীতে অফিসার ক্যাডেট পদে নিয়োগ চলছে। ভিজিট করুন: http://joinnavy.navy.mil.bd",
    '২২ সেপ্টেম্বর ২০২৯ "বিশ্ব ব্যক্তিগত গাড়িমুক্ত দিবস"। "গণপরিবহনে ও হেঁটে চলি, ব্যক্তিগত গাড়ি সীমিত করি"-ডিটিসিএ।',
    # ফ্লেক্সিলোড/রিচার্জ নিশ্চিতকরণ
    "আপনি সফলভাবে 20.00 টাকা রিচার্জ করেছেন। Transaction ID is BD030225192022138766. MyGP দেখুন রিচার্জে আকর্ষণীয় ক্যাশব্যাক পেতে https://mygp.li/sn",
    # সুখী ভেরিফিকেশন
    "shukhee নিশ্চিতকরণ কোড: 9299 (দয়া করে এই কোডটি অন্য কারো সাথে শেয়ার করবেন না)",
    # জিপি শুভেচ্ছা এবং অভিনন্দন
    "৮ বছর আগে আজকের দিনেই শুরু হয়েছিল গ্রামীণফোনের সাথে আপনার পথচলা। আশা করি আগামী দিনগুলো হবে আরো সুন্দর ও সন্তুষ্টিবনাময়।",
    "৯ বছর আগে আজকের দিনেই শুরু হয়েছিল গ্রামীণফোনের সাথে আপনার পথচলা। আশা করি আগামী দিনগুলো হবে আরো সুন্দর ও সন্তুষ্টিবনাময়।",
]

def generate_unique_link():
    domains = ["bit.ly", "tinyurl.com", "cutt.ly", "rb.gy", "t.ly", "shorturl.at", "is.gd", "goo.gl"]
    domain = random.choice(domains)
    # Generate a random string of 5-8 characters
    chars = string.ascii_letters + string.digits
    path = ''.join(random.choice(chars) for _ in range(random.randint(5, 8)))
    return f"{domain}/{path}"

def generate_spam_message():
    template = random.choice(spam_patterns)

    companies = ["গ্রামীণফোন", "রবি", "বাংলালিংক", "টেলিটক", "বিকাশ", "নগদ", "রকেট", "ডাচ-বাংলা ব্যাংক", "CITY_AMEX", "আইবিবিএল", "প্রথম ব্যাংক", "মিউচুয়াল ট্রাস্ট", "ইস্টার্ন ব্যাংক", "সোনালী ব্যাংক", "জনতা ব্যাংক", "এনআরবি ব্যাংক"]
    banks = ["ডাচ-বাংলা ব্যাংক", "ব্র্যাক ব্যাংক", "ইসলামী ব্যাংক", "এবি ব্যাংক", "সিটি ব্যাংক", "বিকাশ", "নগদ", "JANATA BANK", "TrustBank", "মার্কেন্টাইল ব্যাংক", "ইউনাইটেড ব্যাংক", "প্রিমিয়ার ব্যাংক", "স্ট্যান্ডার্ড ব্যাংক", "আইএফআইসি ব্যাংক", "ট্রাস্ট ব্যাংক"]
    products = ["আইফোন", "স্মার্টফোন", "ল্যাপটপ", "টিভি", "ফ্রিজ", "এসি", "মোবাইল", "ট্যাবলেট", "ওয়াচ", "জামা", "জুতা", "সোফা", "বেড", "ক্যামেরা", "হেডফোন", "স্পিকার", "মাইক্রোওয়েভ", "ওয়াশিং মেশিন", "ইয়ারফোন", "পাওয়ার ব্যাংক"]
    prizes = ["বাইক", "গাড়ি", "স্মার্টফোন", "ল্যাপটপ", "উমরাহ প্যাকেজ", "গোল্ড কয়েন", "মেম্বারশিপ রিওয়ার্ডস", "ট্যাবলেট", "টিভি", "হজ্জ প্যাকেজ", "ডায়মন্ড রিং", "ফ্রি টিকেট"]
    medicines = ["সেক্স পাওয়ার", "হাইট ইনক্রিজ", "ওজন কমানোর", "চুল পড়া বন্ধ", "ডায়াবেটিস নিয়ন্ত্রণ", "প্রেসার কমানোর", "শক্তি বৃদ্ধি", "ত্বক ফর্সা"]
    locations = ["ধানমন্ডি", "গুলশান", "বনানী", "উত্তরা", "মিরপুর", "বসুন্ধরা", "চট্টগ্রাম", "সিলেট", "রাজশাহী", "খুলনা", "বরিশাল", "রংপুর", "কুমিল্লা", "ময়মনসিংহ", "নারায়ণগঞ্জ", "গাজীপুর", "মতিঝিল", "কাকরাইল", "পল্টন", "শাহবাগ"]
    operators = ["গ্রামীণফোন", "রবি", "বাংলালিংক", "টেলিটক", "এয়ারটেল"]
    dates = ["15-21", "1-7", "21-25", "5-10", "1-5", "10-15", "20-30", "1-10"]
    years = ["2025", "2026", "2027", "2024"]
    counts = [1, 2, 3, 5, 10, 15, 20, 25, 30]
    
    # New lists for new patterns
    names = ["রাহিম", "করিম", "সুমনা", "রিনা", "বাবুল", "সাজু", "মিতা", "রাজু", "নিপা", "তিশা", "আরিফ", "সালাম", "জসিম", "রফিক", "শফিক", "তানিয়া", "লিজা", "মিমি", "পপি", "রুবেল", "সোহেল", "রানা", "মাসুম", "বিপুল", "শিমুল", "পলাশ", "বকুল", "শিউলি", "চম্পা", "বেলি", "শেখ হাসিনা", "খালেদা জিয়া", "এরশাদ", "ওবায়দুল কাদের", "মির্জা ফখরুল"]
    girl_names = ["প্রিয়া", "নিশি", "তিশা", "মিমি", "লিজা", "পপি", "রিয়া", "সাদিয়া", "ফারজানা", "তানিয়া", "সুমাইয়া", "জেসি", "নাবিলা"]
    parties = ["আওয়ামী লীগ", "বিএনপি", "জাতীয় পার্টি", "জামায়াত", "সিপিবি", "বাসদ"]
    symbols = ["নৌকা", "ধানের শীষ", "লাঙ্গল", "দাঁড়িপাল্লা", "কাস্তে", "মশাল"]

    message = template.format(
        phone=f"0{random.randint(1500000000, 1999999999)}",
        amount=random.choice([5000, 10000, 25000, 50000, 100000, 200000, 500000, 1000000, 5000000]),
        percent=random.choice([5, 10, 15, 20, 25, 30, 40, 50, 60, 70, 80, 90]),
        product=random.choice(products),
        prize=random.choice(prizes),
        price=random.choice([999, 1500, 2500, 3999, 4999, 9999, 15000, 25000]),
        code=random.randint(1000, 99999),
        hour=random.choice([1, 2, 3, 6, 12, 24, 48]),
        company=random.choice(companies),
        bank=random.choice(banks),
        link=generate_unique_link(), # Use the new unique link generator
        medicine=random.choice(medicines),
        location=random.choice(locations),
        size=random.choice([650, 850, 1000, 1200, 1400, 1600]),
        deposit=random.choice([50000, 100000, 200000, 500000]),
        fee=random.choice([200, 300, 500, 1000, 2000]),
        investment=random.choice([5000, 10000, 20000, 50000, 100000]),
        operator=random.choice(operators),
        gb=random.choice([1, 2, 3, 5, 10, 15, 20]),
        date=random.choice(dates),
        year=random.choice(years),
        count=random.choice(counts),
        name=random.choice(names),
        girl_name=random.choice(girl_names),
        party=random.choice(parties),
        symbol=random.choice(symbols)
    )
    return message

def generate_ham_message():
    base_msg = random.choice(ham_patterns)
    
    if any(char.isdigit() for char in base_msg):
        base_msg = re.sub(r'01[3-9]\d{8}', lambda x: f"01{random.randint(3,9)}{random.randint(10000000,99999999)}", base_msg)
        base_msg = re.sub(r'\b\d{3,}\b', lambda x: str(random.randint(100, 99999)), base_msg)
        if "TrxID" in base_msg:
             base_msg = re.sub(r'TrxID [A-Z0-9]+', f'TrxID {random.choice(["A","B","C"])}{random.randint(100000000, 999999999)}', base_msg)
    else:
        names = ["রাহিম", "করিম", "সুমনা", "রিনা", "বাবুল", "সাজু", "মিতা", "রাজু", "নিপা", "তিশা", "আরিফ", "সালাম", "জসিম", "রফিক", "শফিক", "তানিয়া", "লিজা", "মিমি", "পপি", "রুবেল", "সোহেল", "রানা", "মাসুম", "বিপুল", "শিমুল", "পলাশ", "বকুল", "শিউলি", "চম্পা", "বেলি"]
        greetings = ["হাই", "হ্যালো", "শোন", "এই যে", "ওহে", "সালাম", "আদাব", "শুভ সকাল", "শুভ বিকাল", "শুভ সন্ধ্যা"]
        closings = ["ভালো থেকো", "আল্লাহ হাফেজ", "বাই", "পরে কথা হবে", "রাখি", "টাটা", "ধন্যবাদ", "ওকে", "ঠিক আছে"]
        
        variation = random.random()
        if variation < 0.2:
            base_msg = f"{random.choice(names)}, {base_msg}"
        elif variation < 0.4:
            base_msg = f"{random.choice(greetings)}, {base_msg}"
        elif variation < 0.6:
            base_msg = f"{base_msg} - {random.choice(names)}"
        elif variation < 0.8:
            base_msg = f"{base_msg} {random.choice(closings)}।"
            
    return base_msg

# --- Main Generation Logic ---
if __name__ == "__main__":
    spam_messages = set()
    ham_messages = set()

    target_spam = 6000
    target_ham = 6000

    print(f"Generating {target_spam} Spam messages...")
    while len(spam_messages) < target_spam:
        msg = generate_spam_message()
        spam_messages.add(msg)
        if len(spam_messages) % 1000 == 0:
            print(f"Spam: {len(spam_messages)}/{target_spam}")

    print(f"Generating {target_ham} Ham messages...")
    while len(ham_messages) < target_ham:
        msg = generate_ham_message()
        ham_messages.add(msg)
        if len(ham_messages) % 1000 == 0:
            print(f"Ham: {len(ham_messages)}/{target_ham}")

    data = [{"label": "spam", "text": msg} for msg in spam_messages]
    data.extend([{"label": "ham", "text": msg} for msg in ham_messages])
    random.shuffle(data)

    output_file = "enhanced_bangla_sms_dataset.csv"
    with open(output_file, "w", newline="", encoding="utf-8") as f:
        writer = csv.DictWriter(f, fieldnames=["label", "text"])
        writer.writeheader()
        writer.writerows(data)

    print(f"\n✅ Enhanced dataset created: {output_file}")
    print(f"Total messages: {len(data)}")
    print(f"Spam: {len(spam_messages)}")
    print(f"Ham: {len(ham_messages)}")
